# This is an auto generated Dockerfile for ros:desktop
# generated from docker_images_ros2/create_ros_image.Dockerfile.em
FROM ros:humble-ros-base-jammy


ENV DEBIAN_FRONTEND=noninteractive
# install ros2 packages
RUN apt-get update && apt-get install -y --no-install-recommends \
    ros-humble-desktop=0.10.0-1* \
    && rm -rf /var/lib/apt/lists/*
#RUN apt-get install ros-humble-test-msgs \
#    && rm -rf /var/lib/apt/lists/*


RUN apt-get update && apt-get install -y mesa-utils && apt-get install -y gedit

RUN apt-get update && apt-get install -y lsb-release wget gnupg
RUN wget https://packages.osrfoundation.org/gazebo.gpg -O /usr/share/keyrings/pkgs-osrf-archive-keyring.gpg
RUN echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/pkgs-osrf-archive-keyring.gpg] http://packages.osrfoundation.org/gazebo/ubuntu-stable $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/gazebo-stable.list > /dev/null
RUN apt-get update && apt-get install -y ignition-fortress
RUN apt-get install -y git
RUN apt-get install -y ros-humble-tf-transformations
RUN apt-get install -y python3-pip
RUN pip install transforms3d
RUN pip install pgm_reader
RUN pip install casadi
RUN pip install numba
RUN pip install control

#PIGPIO
RUN apt install -y python-setuptools python3-setuptools
RUN apt-get install -y python3-pip
RUN wget https://github.com/joan2937/pigpio/archive/master.zip
RUN unzip master.zip
RUN cd pigpio-master && make && make install
RUN apt install -y xsltproc

#FOR NAV2
RUN apt-get install -y libmagick++-dev
RUN apt install -y graphicsmagick-libmagick-dev-compat
RUN apt-get update
RUN apt install -y ros-humble-behaviortree-cpp-v3
RUN apt install -y ros-humble-navigation2 
RUN apt install -y ros-humble-nav2-bringup

# VISUALIZATION
RUN apt-get update
RUN apt install -y ros-humble-plotjuggler-ros

#CERES
## Install packages
#RUN apt-get update -q && \
#    apt-get install -y --fix-missing --no-install-recommends \
#    cmake \
#    libgoogle-glog-dev libgflags-dev \
#    libatlas-base-dev \
#    libeigen3-dev \
#    libsuitesparse-dev \
#    libmetis-dev

#RUN git clone --depth=1 https://ceres-solver.googlesource.com/ceres-solver && \
#    cd ceres-solver && \
#    mkdir build && \
#    cd build && \
#    cmake -DOPENMP=OFF \
#          -DCXX11=ON \
#          -DBUILD_DOCUMENTATION=ON \
#          .. && \
#    make -j3 && \
#    make test && \
#    make install









#SHELL COLOR
SHELL ["/bin/bash", "-c"]
RUN echo 'export PS1="\[\e]0;\u@\h: \w\a\]${debian_chroot:+($debian_chroot)}\[\033[01;37m\]\u\[\033[00m\]@\[\033[01;32m\]\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\] "'  >> /root/.bashrc
RUN echo 'export COPPELIASIM_ROOT_DIR=/home/coppeliasim_simulation/CoppeliaSim' >> /root/.bashrc
RUN echo '. /home/ros2_ws/install/setup.bash' >> /root/.bashrc

RUN echo 'alias rviz2="ros2 run rviz2 rviz2 -d /home/ros2_ws/src/utilities/rviz_config/common.rviz"' >> /root/.bashrc
RUN echo 'alias coppelia="cd /home/coppeliasim_simulation/CoppeliaSim && ./coppeliaSim.sh ../self_balancing_robot.ttt"' >> /root/.bashrc


WORKDIR /home
RUN source /root/.bashrc




